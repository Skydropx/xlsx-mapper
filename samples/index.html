<html>
  <head>
    <meta charset="utf-8">
  </head>
  <body>
    
    <input type="file" id="fileInput">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.6/cpexcel.js" charset="utf-8"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.6/ods.js" charset="utf-8"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.6/xlsx.core.min.js" charset="utf-8"></script>

    <script type="text/javascript" src="../lib/XLSXMapper.js" charset="utf-8"></script>
    <script type="text/javascript">
      var fileInputEl = document.getElementById('fileInput');

      fileInputEl.onchange = function (e) {
        var el = document.getElementById('fileInput');
        var fileReader = new FileReader();
        
        fileReader.onload = function (e) {
          var data = e.target.result;
          var opts = {
            type: "browser",
            xlsx: XLSX,
            fileToParse: {fileData: data},
            columnsToTransform: {
              'A': { type: 'autoincrement' },
              'B': { type: 'fixedvalue', value: '55 2558 0633' },
              'C': { type: 'fixedvalue', value: 'AMAZON' },
              'D': { type: 'fixedvalue', value: 'na' },
              'E': { type: 'fixedvalue', value: 'Pedro Celestino Negrete 820' },
              'F': { type: 'fixedvalue', value: 'na' },
              'G': { type: 'fixedvalue', value: 'Industrial' },
              'H': { type: 'fixedvalue', value: 'Monterrey' },
              'I': { type: 'fixedvalue', value: 'na' },
              'J': { type: 'fixedvalue', value: 'na' },
              'K': { type: 'match', value: 'Receiver Phone' },
              'L': { type: 'match', value: 'Holder Name' },
              'M': { type: 'fixedvalue', value: 'na' },
              'N': { type: 'transformStreet', value: 'Detail Address' },
              'O': { type: 'fixedvalue', value: 'na' },
              'P': { type: 'transformNeighborhood', value: 'Detail Address' },
              'Q': { type: 'fixedvalue', value: 'City' },
              'R': { type: 'fixedvalue', value: 'na' },
              'S': { type: 'fixedvalue', value: 'Tracking Id' },
              'T': { type: 'fixedvalue', value: '0' },
              'U': { type: 'fixedvalue', value: '0' },
              'V': { type: 'fixedvalue', value: '0' },
              'W': { type: 'fixedvalue', value: '0' },
              'X': { type: 'fixedvalue', value: 'car' },
            },
            grouperType: 'column',
            column: 'Associate'
          };

          var xlsxMapper = new XLSXMapper(opts);
          xlsxMapper.read();
          console.log(xlsxMapper.convertToArrayOfSheets())
        }
        fileReader.readAsBinaryString(el.files[0]);
      };
      // var xlsxMapper = new Library();
    </script>
  </body>
</html>
